@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Serif+4:ital,ops,wght@0,8..144,300..900;1,8..144,300..900&display=swap");
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 22.22 8.27% 16.86%;
    --muted: 220 7.14% 92.94%;
    --muted-foreground: 220 8.89% 46.86%;
    --popover: 0 0% 100%;
    --popover-foreground: 22.22 8.27% 16.86%;
    --card: 0 0% 100%;
    --card-foreground: 22.22 8.27% 16.86%;
    --border: 214.3 63.8% 69.8%;
    --input: 214.3 63.8% 69.8%;
    --ring: 22.22 8.27% 16.86%;
    --primary: 22.22 8.27% 16.86%;
    --primary-foreground: 0 0% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 22.22 8.27% 16.86%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 22.22 8.27% 16.86%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 0 0% 7%;
    --foreground: 0 0% 98%;
    --muted: 0 0% 15%;
    --muted-foreground: 240 5% 64%;
    --accent: 0 0% 15%;
    --accent-foreground: 0 0% 98%;
    --popover: 0 0% 7%;
    --popover-foreground: 0 0% 98%;
    --card: 0 0% 7%;
    --card-foreground: 0 0% 98%;
    --border: 0 0% 15%;
    --input: 0 0% 15%;
    --ring: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 7%;
    --secondary: 0 0% 15%;
    --secondary-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings:
      "rlig" 1,
      "calt" 1;
  }
}

/* Enhanced Reddit-Style UI Tokens - v8.0 */
:root {
  /* Existing tokens preserved */
  --background: 220 20% 98%;
  --foreground: 220 10% 15%;
  --surface: 220 20% 94%;
  --surface-muted: 220 20% 88%;
  --border: 220 10% 85%;
  --border-hover: 220 10% 75%;
  --primary: 220 10% 10%;
  --primary-foreground: 210 40% 98%;
  --text-primary: 220 10% 15%;
  --text-secondary: 220 10% 35%;

  /* NEW: Enhanced hierarchy and Reddit-style tokens */
  --text-tertiary: 220 10% 48%;      /* Less important metadata */
  --surface-hover: 220 20% 91%;      /* Subtle hover backgrounds */
  --border-strong: 220 10% 70%;      /* Emphasized separators */
  --comment-thread: 220 10% 82%;     /* Threading lines */
  --action-hover: 220 20% 85%;       /* Action button hover states */
  
  /* Reddit spacing system */
  --spacing-reddit-xs: 0.5rem;       /* 8px */
  --spacing-reddit-sm: 0.75rem;      /* 12px */
  --spacing-reddit-md: 1rem;         /* 16px */
  --spacing-reddit-lg: 1.5rem;       /* 24px */
  --spacing-reddit-xl: 2rem;         /* 32px */
}

.dark {
  /* Existing dark theme tokens preserved */
  --background: 0 0% 7%;
  --foreground: 210 40% 95%;
  --surface: 0 0% 10%;
  --surface-muted: 0 0% 13%;
  --border: 0 0% 16%;
  --border-hover: 0 0% 18%;
  --primary: 210 40% 98%;
  --primary-foreground: 0 0% 7%;
  --text-primary: 210 40% 95%;
  --text-secondary: 0 0% 28%;

  /* NEW: Dark theme Reddit-style tokens */
  --text-tertiary: 0 0% 48%;          /* Less important metadata */
  --surface-hover: 0 0% 8%;           /* Subtle hover backgrounds */
  --border-strong: 0 0% 20%;          /* Emphasized separators */
  --comment-thread: 0 0% 20%;         /* Threading lines */
  --action-hover: 0 0% 12%;           /* Action button hover states */
}

@layer typography {
  .prose {
    @apply max-w-none;
  }

  .prose p {
    @apply mb-4;
  }

  .prose h1 {
    @apply text-3xl font-bold mb-6 mt-8;
  }

  .prose h2 {
    @apply text-2xl font-semibold mb-4 mt-6;
  }

  .prose h3 {
    @apply text-xl font-semibold mb-3 mt-5;
  }

  .prose h4 {
    @apply text-lg font-semibold mb-2 mt-4;
  }

  .prose ul {
    @apply list-disc pl-5 mb-4;
  }

  .prose ol {
    @apply list-decimal pl-5 mb-4;
  }

  .prose li {
    @apply mb-2;
  }

  .prose a {
    @apply text-primary underline;
  }

  .prose strong {
    @apply font-semibold;
  }

  .prose code {
    @apply bg-muted rounded-md px-1 py-0.5 font-mono text-sm;
  }

  .prose pre {
    @apply bg-muted rounded-md p-4 overflow-x-auto;
  }

  .prose blockquote {
    @apply border-l-2 border-primary pl-4 italic;
  }

  .prose table {
    @apply w-full text-sm;
  }

  .prose th {
    @apply font-semibold text-left py-2 px-4 border-b;
  }

  .prose td {
    @apply text-left py-2 px-4 border-b;
  }

  .prose img {
    @apply rounded-md;
  }

  .prose hr {
    @apply border-border my-8;
  }
}

/* NEW: Reddit-Style Component Classes */
@layer components {
  /* Post De-boxing */
  .reddit-post-item {
    @apply bg-transparent border-0 shadow-none rounded-none;
    @apply border-b border-border last:border-b-0;
    @apply px-4 py-3 hover:bg-surface-hover/30 transition-colors duration-150;
  }

  /* Comment Threading System */
  .reddit-comment-thread {
    @apply space-y-0;
  }

  .reddit-comment-node {
    @apply relative;
  }

  .reddit-thread-line {
    @apply absolute w-0.5 bg-comment-thread;
    @apply hover:bg-border-strong transition-colors duration-150;
  }

  .reddit-thread-toggle {
    @apply absolute w-4 h-4 bg-background border border-comment-thread rounded-sm;
    @apply hover:bg-surface-muted hover:border-border-hover transition-all duration-150;
    @apply flex items-center justify-center cursor-pointer z-10;
  }

  .reddit-comment-content {
    @apply relative;
  }

  /* Vote Buttons Horizontal */
  .reddit-vote-buttons {
    @apply flex flex-row items-center gap-1;
  }

  .reddit-vote-button {
    @apply border-0 shadow-none bg-transparent;
    @apply hover:bg-action-hover transition-colors duration-150;
  }

  .reddit-vote-score {
    @apply font-semibold min-w-[2rem] text-center text-foreground;
  }

  /* Sidebar De-boxing */
  .reddit-sidebar-module {
    @apply bg-transparent border-0 shadow-none mb-6 last:mb-0;
  }

  .reddit-sidebar-header {
    @apply text-sm font-semibold text-foreground mb-3;
    @apply border-b border-border/30 pb-2;
  }

  .reddit-sidebar-content {
    @apply space-y-2;
  }

  /* Post Structure Unified */
  .reddit-post-header {
    @apply flex items-center gap-2 mb-3;
  }

  .reddit-post-meta {
    @apply text-xs text-text-tertiary flex items-center gap-2;
  }

  .reddit-post-body {
    @apply text-sm text-foreground/80 leading-relaxed mb-3;
  }

  .reddit-post-actions {
    @apply flex items-center gap-4 text-xs text-text-secondary;
  }
}
